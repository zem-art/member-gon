<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BeliKilat - Belanja Tanpa Ribet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
        }

        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .active-tab {
            color: #2563eb;
            border-top: 2px solid #2563eb;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-900 min-h-screen pb-20 md:pb-0">

    <div id="app">
        <!-- Navigation Desktop -->
        <nav
            class="hidden md:flex sticky top-0 bg-white/80 backdrop-blur-md border-b z-40 px-6 py-4 justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer" onclick="navigate('home')">
                <div
                    class="w-10 h-10 bg-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-xl">
                    B</div>
                <h1 class="text-xl font-bold tracking-tight">BeliKilat</h1>
            </div>
            <div class="flex items-center gap-8">
                <button onclick="navigate('home')" class="hover:text-blue-600 transition">Beranda</button>
                <button onclick="navigate('tracking')" class="hover:text-blue-600 transition">Lacak Pesanan</button>
                <button onclick="navigate('history')" class="hover:text-blue-600 transition">Riwayat</button>
                <button onclick="toggleCart()"
                    class="relative p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="8" cy="21" r="1" />
                        <circle cx="19" cy="21" r="1" />
                        <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12" />
                    </svg>
                    <span id="cart-count-desktop"
                        class="absolute -top-1 -right-1 bg-red-500 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full border-2 border-white">0</span>
                </button>
            </div>
        </nav>

        <!-- Main Content Wrapper -->
        <main class="max-w-7xl mx-auto px-4 py-6 md:py-10">

            <!-- VIEW: HOME -->
            <section id="view-home" class="view space-y-8">
                <div
                    class="bg-gradient-to-r from-blue-600 to-indigo-700 rounded-3xl p-8 text-white relative overflow-hidden">
                    <div class="relative z-10 max-w-lg">
                        <h2 class="text-3xl md:text-4xl font-bold mb-4">Bayar Lewat VA, Gak Pakai Akun!</h2>
                        <p class="text-blue-100 mb-6">Pilih produk favoritmu, checkout langsung dengan Virtual Account
                            pilihanmu. Cepat dan aman.</p>
                        <button onclick="document.getElementById('product-list').scrollIntoView({behavior: 'smooth'})"
                            class="bg-white text-blue-600 px-6 py-3 rounded-full font-bold hover:shadow-lg transition">Mulai
                            Belanja</button>
                    </div>
                </div>

                <div id="product-list" class="grid grid-cols-2 lg:grid-cols-4 gap-4 md:gap-8">
                    <!-- Products injected by JS -->
                </div>
            </section>

            <!-- VIEW: TRACKING -->
            <section id="view-tracking" class="view hidden max-w-2xl mx-auto">
                <div class="bg-white rounded-3xl p-8 shadow-sm border">
                    <h2 class="text-2xl font-bold mb-6">Lacak Pesanan</h2>
                    <div class="flex gap-2 mb-8">
                        <input type="text" id="track-id-input" placeholder="Masukkan ID Pesanan (cth: INV-12345)"
                            class="flex-1 bg-gray-50 border rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <button onclick="handleTrackOrder()"
                            class="bg-blue-600 text-white px-6 py-3 rounded-xl font-bold">Cari</button>
                    </div>
                    <div id="tracking-result" class="hidden space-y-6">
                        <!-- Tracking info injected here -->
                    </div>
                </div>
            </section>

            <!-- VIEW: HISTORY -->
            <section id="view-history" class="view hidden max-w-2xl mx-auto">
                <h2 class="text-2xl font-bold mb-6">Riwayat Pesanan</h2>
                <div id="history-list" class="space-y-4">
                    <!-- History items injected here -->
                </div>
            </section>

            <!-- VIEW: PAYMENT DETAIL (NEW) -->
            <section id="view-payment" class="view hidden max-w-xl mx-auto space-y-6">
                <div class="bg-white rounded-3xl p-8 shadow-sm border text-center">
                    <div
                        class="w-16 h-16 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="2" y="5" width="20" height="14" rx="2" />
                            <line x1="2" y1="10" x2="22" y2="10" />
                        </svg>
                    </div>
                    <h2 class="text-2xl font-bold mb-2">Selesaikan Pembayaran</h2>
                    <p class="text-gray-500 text-sm mb-8">Silakan transfer ke nomor Virtual Account di bawah ini sebelum
                        batas waktu berakhir.</p>

                    <div class="bg-gray-50 rounded-2xl p-6 border mb-6">
                        <p class="text-xs text-gray-400 uppercase font-bold tracking-widest mb-1">Bank Transfer (VA)</p>
                        <h3 id="payment-bank-name" class="text-lg font-bold mb-4 italic text-blue-900">MANDIRI VIRTUAL
                            ACCOUNT</h3>

                        <div class="flex items-center justify-between bg-white border rounded-xl p-4">
                            <span id="payment-va-number"
                                class="text-xl font-mono font-bold tracking-wider">8801234567890123</span>
                            <button onclick="copyToClipboard('payment-va-number')"
                                class="text-blue-600 text-xs font-bold hover:underline">SALIN</button>
                        </div>
                    </div>

                    <div class="flex justify-between items-center px-4 mb-8">
                        <div class="text-left">
                            <p class="text-xs text-gray-400">Total Tagihan</p>
                            <p id="payment-amount" class="text-2xl font-bold text-blue-600">Rp 0</p>
                        </div>
                        <div class="text-right">
                            <p class="text-xs text-gray-400">Batas Waktu</p>
                            <p class="text-sm font-bold text-red-500">23:59:59</p>
                        </div>
                    </div>

                    <button onclick="navigate('history')"
                        class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold">Cek Status Pembayaran</button>
                    <button onclick="navigate('home')" class="w-full mt-4 text-gray-400 text-sm font-medium">Nanti
                        Saja</button>
                </div>

                <div class="bg-blue-50 border border-blue-100 rounded-2xl p-6">
                    <h4 class="font-bold text-sm mb-3">Cara Pembayaran:</h4>
                    <ul class="text-xs text-gray-600 space-y-2 text-left list-disc pl-4">
                        <li>Buka aplikasi Mobile Banking atau kunjungi ATM terdekat.</li>
                        <li>Pilih menu Transfer / Pembayaran > Virtual Account.</li>
                        <li>Masukkan nomor Virtual Account yang tertera di atas.</li>
                        <li>Pastikan nominal sesuai dengan total tagihan.</li>
                        <li>Simpan bukti transaksi Anda.</li>
                    </ul>
                </div>
            </section>

        </main>

        <!-- Floating Cart Drawer -->
        <div id="cart-drawer" class="fixed inset-0 bg-black/50 z-50 transition-opacity opacity-0 pointer-events-none">
            <div
                class="absolute right-0 top-0 bottom-0 w-full max-w-md bg-white shadow-2xl transform translate-x-full transition-transform duration-300 flex flex-col">
                <div class="p-6 border-b flex justify-between items-center">
                    <h3 class="text-xl font-bold">Keranjang Anda</h3>
                    <button onclick="toggleCart()" class="p-2 hover:bg-gray-100 rounded-full">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="6" x2="6" y2="18" />
                            <line x1="6" y1="6" x2="18" y2="18" />
                        </svg>
                    </button>
                </div>
                <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4">
                    <!-- Cart items injected here -->
                </div>
                <div class="p-6 border-t bg-gray-50">
                    <div class="flex justify-between items-center mb-6">
                        <span class="text-gray-600">Total Pembayaran</span>
                        <span id="cart-total" class="text-xl font-bold text-blue-600">Rp 0</span>
                    </div>
                    <button id="btn-checkout-start" onclick="openCheckoutModal()"
                        class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold hover:bg-blue-700 transition shadow-lg shadow-blue-200">Lanjut
                        ke Pembayaran</button>
                </div>
            </div>
        </div>

        <!-- Checkout Modal -->
        <div id="checkout-modal"
            class="fixed inset-0 bg-black/60 z-[60] flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity">
            <div class="bg-white w-full max-w-lg rounded-3xl p-8 max-h-[90vh] overflow-y-auto shadow-2xl">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold">Detail Pengiriman</h3>
                    <button onclick="closeCheckoutModal()" class="text-gray-400 hover:text-gray-600">&times;</button>
                </div>
                <form id="checkout-form" onsubmit="handleCheckout(event)" class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold mb-1 text-gray-700">Kode Member</label>
                        <input type="text" name="code_member" required
                            class="w-full border p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1 text-gray-700">Nama Lengkap</label>
                        <input type="text" name="name" required
                            class="w-full border p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1 text-gray-700">Email</label>
                        <input type="email" name="email" placeholder="you@mail.com" required
                            class="w-full border p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1 text-gray-700">Nomor WhatsApp</label>
                        <input type="tel" name="phone" placeholder="08xxxx" required
                            class="w-full border p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1 text-gray-700">Alamat Lengkap</label>
                        <textarea name="address" required
                            class="w-full border p-3 rounded-xl h-24 focus:ring-2 focus:ring-blue-500 outline-none"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold mb-1 text-gray-700">Metode Pembayaran (VA)</label>
                        <select name="bank"
                            class="w-full border p-3 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none">
                            <option value="Mandiri">Mandiri Virtual Account</option>
                            <option value="BCA">BCA Virtual Account</option>
                            <option value="BNI">BNI Virtual Account</option>
                            <option value="BRI">BRI Virtual Account</option>
                        </select>
                    </div>
                    <div class="pt-4">
                        <button type="submit"
                            class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold hover:bg-blue-700 transition flex items-center justify-center gap-2">
                            Buat Pesanan Sekarang
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Mobile Bottom Nav Chart UP-->
        <nav
            class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t flex justify-around items-center py-3 px-4 z-40 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
            <button onclick="navigate('home')" id="nav-home"
                class="flex flex-col items-center gap-1 text-gray-400 active-tab">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                    <polyline points="9 22 9 12 15 12 15 22" />
                </svg>
                <span class="text-[10px] font-bold">Beranda</span>
            </button>

            <button onclick="navigate('tracking')" id="nav-tracking"
                class="flex flex-col items-center gap-1 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8" />
                    <line x1="21" y1="21" x2="16.65" y2="16.65" />
                </svg>
                <span class="text-[10px] font-bold">Lacak</span>
            </button>

            <button onclick="toggleCart()" class="flex flex-col items-center gap-1 text-gray-400 relative">
                <!-- <div class="bg-blue-600 text-white p-3 -mt-10 rounded-full border-4 border-white shadow-lg"> -->
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="8" cy="21" r="1" />
                    <circle cx="19" cy="21" r="1" />
                    <path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12" />
                </svg>
                <!-- </div> -->
                <span id="cart-count-mobile"
                    class="absolute -top-3 right-0 bg-red-500 text-white text-[10px] w-5 h-5 flex items-center justify-center rounded-full border-2 border-white">0</span>
                <span class="text-[10px] font-bold">Keranjang</span>
            </button>

            <button onclick="navigate('history')" id="nav-history"
                class="flex flex-col items-center gap-1 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 8v4l3 3" />
                    <circle cx="12" cy="12" r="10" />
                </svg>
                <span class="text-[10px] font-bold">Riwayat</span>
            </button>
        </nav>
    </div>

    <script>
        // --- DATA & STATE ---
        const PRODUCTS = [
            { id: 1, name: "Kopi Susu Signature", price: 25000, category: "Minuman", img: "https://images.unsplash.com/photo-1541167760496-1628856ab772?q=80&w=200&auto=format&fit=crop" },
            { id: 2, name: "Premium Hoodie White", price: 189000, category: "Pakaian", img: "https://images.unsplash.com/photo-1556821840-3a63f95609a7?q=80&w=200&auto=format&fit=crop" },
            { id: 3, name: "Wireless Earbuds G2", price: 345000, category: "Elektronik", img: "https://images.unsplash.com/photo-1590658268037-6bf12165a8df?q=80&w=200&auto=format&fit=crop" },
            { id: 4, name: "Mechanical Keyboard", price: 750000, category: "Elektronik", img: "https://images.unsplash.com/photo-1511467687858-23d96c32e4ae?q=80&w=200&auto=format&fit=crop" },
            { id: 5, name: "Choco Lava Cake", price: 35000, category: "Makanan", img: "https://images.unsplash.com/photo-1624353365286-3f8d62daad51?q=80&w=200&auto=format&fit=crop" },
            { id: 6, name: "Tote Bag Kanvas", price: 45000, category: "Aksesoris", img: "https://images.unsplash.com/photo-1544816155-12df9643f363?q=80&w=200&auto=format&fit=crop" }
        ];

        let state = {
            currentView: 'home',
            cart: [],
            orderHistory: JSON.parse(localStorage.getItem('orderHistory')) || [],
            activePayment: null
        };

        // --- NAVIGATION ---
        function navigate(viewName) {
            state.currentView = viewName;
            document.querySelectorAll('.view').forEach(el => el.classList.add('hidden'));
            document.getElementById(`view-${viewName}`).classList.remove('hidden');

            // Update mobile active state
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active-tab', 'text-blue-600'));
            const mobileBtn = document.getElementById(`nav-${viewName}`);
            if (mobileBtn) {
                mobileBtn.classList.add('active-tab', 'text-blue-600');
            }

            if (viewName === 'history') renderHistory();
            window.scrollTo(0, 0);
        }

        // --- CART LOGIC ---
        function toggleCart() {
            const drawer = document.getElementById('cart-drawer');
            const inner = drawer.querySelector('div');
            const isClosing = drawer.classList.contains('opacity-100');

            if (isClosing) {
                drawer.classList.replace('opacity-100', 'opacity-0');
                drawer.classList.add('pointer-events-none');
                inner.classList.add('translate-x-full');
            } else {
                drawer.classList.replace('opacity-0', 'opacity-100');
                drawer.classList.remove('pointer-events-none');
                inner.classList.remove('translate-x-full');
                renderCart();
            }
        }

        function addToCart(prodId) {
            const prod = PRODUCTS.find(p => p.id === prodId);
            const existing = state.cart.find(item => item.id === prodId);

            if (existing) {
                existing.qty++;
            } else {
                state.cart.push({ ...prod, qty: 1 });
            }
            updateCartCounter();
            showToast(`${prod.name} ditambahkan!`);
        }

        function updateQty(id, delta) {
            const item = state.cart.find(i => i.id === id);
            if (item) {
                item.qty += delta;
                if (item.qty <= 0) {
                    state.cart = state.cart.filter(i => i.id !== id);
                }
            }
            renderCart();
            updateCartCounter();
        }

        function updateCartCounter() {
            const count = state.cart.reduce((acc, curr) => acc + curr.qty, 0);
            document.getElementById('cart-count-desktop').innerText = count;
            document.getElementById('cart-count-mobile').innerText = count;
        }

        function renderCart() {
            const container = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');
            let total = 0;

            if (state.cart.length === 0) {
                container.innerHTML = `<div class="text-center py-10 opacity-40"><p>Keranjang masih kosong</p></div>`;
                totalEl.innerText = "Rp 0";
                document.getElementById('btn-checkout-start').disabled = true;
                return;
            }

            document.getElementById('btn-checkout-start').disabled = false;
            container.innerHTML = state.cart.map(item => {
                total += item.price * item.qty;
                return `
                    <div class="flex gap-4 bg-white p-3 rounded-2xl border">
                        <img src="${item.img}" class="w-16 h-16 rounded-xl object-cover">
                        <div class="flex-1">
                            <h4 class="font-bold text-sm leading-tight">${item.name}</h4>
                            <p class="text-blue-600 text-sm font-bold mt-1">Rp ${item.price.toLocaleString('id-ID')}</p>
                            <div class="flex items-center gap-3 mt-2">
                                <button onclick="updateQty(${item.id}, -1)" class="w-6 h-6 border rounded-full flex items-center justify-center">-</button>
                                <span class="text-xs font-bold">${item.qty}</span>
                                <button onclick="updateQty(${item.id}, 1)" class="w-6 h-6 border rounded-full flex items-center justify-center">+</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            totalEl.innerText = `Rp ${total.toLocaleString('id-ID')}`;
        }

        // --- CHECKOUT LOGIC ---
        function openCheckoutModal() {
            const modal = document.getElementById('checkout-modal');
            modal.classList.replace('opacity-0', 'opacity-100');
            modal.classList.remove('pointer-events-none');
        }

        function closeCheckoutModal() {
            const modal = document.getElementById('checkout-modal');
            modal.classList.replace('opacity-100', 'opacity-0');
            modal.classList.add('pointer-events-none');
        }

        function handleCheckout(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const user = Object.fromEntries(formData.entries());

            const orderId = 'INV-' + Math.floor(10000 + Math.random() * 90000);
            const total = state.cart.reduce((acc, curr) => acc + (curr.price * curr.qty), 0);
            const vaNumber = (user.bank === 'BCA' ? '123' : '880') + Math.floor(1000000000 + Math.random() * 9000000000);

            const newOrder = {
                id: orderId,
                date: new Date().toLocaleString('id-ID'),
                customer: user,
                items: [...state.cart],
                total: total,
                bank: user.bank,
                va: vaNumber,
                status: 'Menunggu Pembayaran'
            };

            // Save to history
            state.orderHistory.unshift(newOrder);
            localStorage.setItem('orderHistory', JSON.stringify(state.orderHistory));

            // Reset Cart
            state.cart = [];
            updateCartCounter();
            closeCheckoutModal();
            toggleCart();

            // Prepare Payment View
            state.activePayment = newOrder;
            document.getElementById('payment-bank-name').innerText = `${user.bank.toUpperCase()} VIRTUAL ACCOUNT`;
            document.getElementById('payment-va-number').innerText = vaNumber;
            document.getElementById('payment-amount').innerText = `Rp ${total.toLocaleString('id-ID')}`;

            navigate('payment');
            showToast("Pesanan Dibuat!");
        }

        // --- TRACKING & HISTORY ---
        function renderHistory() {
            const container = document.getElementById('history-list');
            if (state.orderHistory.length === 0) {
                container.innerHTML = `<div class="bg-white p-10 rounded-3xl text-center opacity-40">Belum ada pesanan.</div>`;
                return;
            }

            container.innerHTML = state.orderHistory.map(order => `
                <div class="bg-white p-6 rounded-3xl border shadow-sm">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <span class="text-xs text-gray-400">${order.date}</span>
                            <h4 class="font-bold text-blue-600">${order.id}</h4>
                        </div>
                        <span class="px-3 py-1 ${order.status === 'Selesai' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'} text-[10px] font-bold rounded-full">${order.status}</span>
                    </div>
                    <div class="space-y-1 mb-4">
                        ${order.items.slice(0, 2).map(item => `<p class="text-xs text-gray-600">â€¢ ${item.name} (${item.qty}x)</p>`).join('')}
                    </div>
                    <div class="flex justify-between items-center pt-4 border-t">
                        <span class="font-bold">Rp ${order.total.toLocaleString('id-ID')}</span>
                        <div class="flex gap-4">
                             ${order.status !== 'Selesai' ? `<button onclick="showOrderPayment('${order.id}')" class="text-blue-600 text-xs font-bold underline">Detail VA</button>` : ''}
                             <button onclick="trackViaId('${order.id}')" class="text-blue-600 text-xs font-bold">Lacak</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showOrderPayment(id) {
            const order = state.orderHistory.find(o => o.id === id);
            if (order) {
                document.getElementById('payment-bank-name').innerText = `${order.bank.toUpperCase()} VIRTUAL ACCOUNT`;
                document.getElementById('payment-va-number').innerText = order.va;
                document.getElementById('payment-amount').innerText = `Rp ${order.total.toLocaleString('id-ID')}`;
                navigate('payment');
            }
        }

        function trackViaId(id) {
            document.getElementById('track-id-input').value = id;
            navigate('tracking');
            handleTrackOrder();
        }

        function handleTrackOrder() {
            const id = document.getElementById('track-id-input').value.toUpperCase();
            const order = state.orderHistory.find(o => o.id === id);
            const resEl = document.getElementById('tracking-result');

            if (!order) {
                resEl.innerHTML = `<p class="text-red-500 text-center font-bold">Pesanan tidak ditemukan.</p>`;
                resEl.classList.remove('hidden');
                return;
            }

            resEl.innerHTML = `
                <div class="p-4 bg-blue-50 rounded-2xl border border-blue-100 mb-6 text-center">
                    <p class="text-xs text-blue-600 font-bold uppercase tracking-wider mb-1">Status Saat Ini</p>
                    <h3 class="text-xl font-bold text-blue-800">${order.status}</h3>
                </div>
                <div class="space-y-6 relative ml-4 border-l-2 border-dashed border-gray-200 pl-8">
                    <div class="relative">
                        <div class="absolute -left-[37px] top-0 w-4 h-4 rounded-full bg-green-500 shadow-[0_0_0_4px_white,0_0_0_6px_rgba(34,197,94,0.2)]"></div>
                        <p class="font-bold text-sm">Pesanan Dibuat</p>
                        <p class="text-xs text-gray-500">${order.date}</p>
                    </div>
                    <div class="relative ${order.status === 'Menunggu Pembayaran' ? 'opacity-30' : ''}">
                        <div class="absolute -left-[37px] top-0 w-4 h-4 rounded-full ${order.status === 'Selesai' ? 'bg-green-500' : 'bg-gray-400'}"></div>
                        <p class="font-bold text-sm">Pembayaran Terkonfirmasi</p>
                    </div>
                    <div class="relative opacity-30">
                        <div class="absolute -left-[37px] top-0 w-4 h-4 rounded-full bg-gray-400"></div>
                        <p class="font-bold text-sm">Sedang Dikirim</p>
                    </div>
                </div>
            `;
            resEl.classList.remove('hidden');
        }

        // --- UTILS ---
        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).innerText;
            const input = document.createElement('input');
            input.value = text;
            document.body.appendChild(input);
            input.select();
            document.execCommand('copy');
            document.body.removeChild(input);
            showToast("Nomor VA disalin!");
        }

        function showToast(msg) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-24 left-1/2 -translate-x-1/2 bg-gray-900 text-white px-6 py-3 rounded-full text-sm font-bold shadow-2xl z-[100] transition-all transform translate-y-10 opacity-0';
            toast.innerText = msg;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.classList.replace('translate-y-10', 'translate-y-0');
                toast.classList.replace('opacity-0', 'opacity-100');
            }, 100);

            setTimeout(() => {
                toast.classList.replace('translate-y-0', 'translate-y-10');
                toast.classList.replace('opacity-100', 'opacity-0');
                setTimeout(() => toast.remove(), 300);
            }, 2500);
        }

        function initProducts() {
            const container = document.getElementById('product-list');
            container.innerHTML = PRODUCTS.map(prod => `
                <div class="bg-white rounded-3xl overflow-hidden shadow-sm hover:shadow-xl transition group">
                    <div class="relative aspect-square overflow-hidden">
                        <img src="${prod.img}" alt="${prod.name}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                        <span class="absolute top-3 left-3 bg-white/90 backdrop-blur px-2 py-1 rounded-lg text-[10px] font-bold shadow-sm">${prod.category}</span>
                    </div>
                    <div class="p-4 md:p-6">
                        <h3 class="font-bold text-sm md:text-base mb-1 line-clamp-1">${prod.name}</h3>
                        <p class="text-blue-600 font-bold mb-4 text-sm md:text-lg">Rp ${prod.price.toLocaleString('id-ID')}</p>
                        <button onclick="addToCart(${prod.id})" class="w-full bg-gray-50 text-blue-600 border border-blue-100 py-3 rounded-xl text-xs md:text-sm font-bold hover:bg-blue-600 hover:text-white transition flex items-center justify-center gap-2">
                            Beli
                        </button>
                    </div>
                </div>
            `).join('');
        }

        window.onload = () => {
            initProducts();
            updateCartCounter();
        }
    </script>
</body>

</html>